# SpringMVC

## 拦截器和过滤器，执行顺序到底是哪个先呢

先说结论，*拦截器和过滤器是按照一定的顺序依次执行的，执行顺序取决于它们在代码中的注册顺序*

### 一、什么是拦截器和过滤器？

拦截器和过滤器都是Web开发中常用的技术，它们主要用于对用户请求进行拦截和处理，可以在请求到达控制器前或返回浏览器前进行一些自定义的操作。

拦截器是Spring框架中的一个组件，它可以对Controller进行拦截，可以在请求到达Controller前或返回浏览器前进行一些自定义的操作。

过滤器是Web中的一种组件，它可以在请求到达Servlet前或返回浏览器前进行一些自定义的操作，可以对请求进行拦截、过滤和修改。

### 二、 拦截器和过滤器的区别

1. 位置不同

拦截器是针对Controller的，只能拦截来自客户端的请求，对于保护应用程序的资源不起作用。

过滤器是Web应用程序层面上的组件，可以过滤请求和响应，对于保护应用程序的资源有良好的作用。

2. 实现方式不同

拦截器是基于Java的反射机制实现的，它继承自HandlerInterceptor，具有三个方法，可以对请求进行处理。

过滤器是基于函数回调实现的，它继承自Filter，具有三个方法，分别代表初始化、请求处理和销毁，可以对请求进行过滤和修改。

3. 使用场景不同

拦截器多用于系统权限的控制、日志的收集、登录验证等，不太适用于请求过滤和修改。

过滤器多用于编码转换、数据压缩、字符集管理等，可以在请求前或响应后进行一些操作。

### 三、拦截器和过滤器执行顺序

拦截器和过滤器是按照一定的顺序依次执行的，执行顺序取决于它们在代码中的注册顺序。SpringMVC中的拦截器和过滤器执行顺序如下：

1. 用户发送请求到服务器，Filter1拦截该请求
2. Filter1执行doFilter方法，将请求传递给下一个过滤器Filter2
3. Filter2执行doFilter方法，将请求传递给下一个过滤器Filter3
4. 过滤器执行链结束后，请求交由Servlet容器处理
5. Servlet处理请求后，将请求传递给DispatcherServlet
6. DispatcherServlet收到请求，对请求进行预处理，这时SpringMVC的拦截器开始处理请求
7. 拦截器的执行顺序与注册顺序相同
8. Controller处理请求后，将处理结果返回给DispatcherServlet
9. DispatcherServlet将响应返回给用户，这时再执行拦截器的afterCompletion方法

需要注意的是，拦截器和过滤器都是基于Servlet容器的，因此它们无法处理静态资源的请求，只能处理动态资源的请求。如果需要处理静态资源的请求，可以通过服务器的发布目录来完成，或者使用SpringMVC的资源处理组件。