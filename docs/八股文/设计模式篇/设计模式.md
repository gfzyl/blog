# 设计模式篇

::: tip 设计模式篇口语回答

本篇记录了关于设计模式的口语话回答

:::

## 讲讲策略模式

策略模式(Strategy Pattern)是一种行为设计模式，主要是将一些共性的方法进行抽取，并提供一个可以进行决策选择的方法，从而进行解耦的快速开发;
平时我们在工作中也能在大量的场景中使用到策略模式，就拿一个营收平台奖励发放的案例来说，一个平中其实存在许许多多的奖励类型比如实物奖励、VIP奖励、代金券奖励、优惠券奖励、现金奖励等等，我们在进行方案设计评估的时候应该也能设想到作为奖励模块随着系统的不断更新迭代会有越来越多的奖励类型加入进来,那么我们在设计这个模块的时候就可以将奖励发放这块逻辑抽象为公性方法，通过每种奖励类型作为决策条件，然后通过不同的决策条件就可以定位到实际的奖励发放逻辑。这样做的好处主要是解耦、基本上可以实现每一种奖励都对应一个奖励发放处理类，后续有需要添加新的奖励类型只要添加对应的奖励发放处理即可，同时对于测试同学来说，他们也不用当心因为你们加多了新的奖励类型而需要去回归之前的所有奖励发放流程。同时也将不同业务进行了类隔离。弊端则是代码编写量会增多，在某些场景下可能会产生类爆炸之类的问题。

## 讲讲建造者模式

构建者模式(Builder Pattern)是一种创建型设计模式，它通过一步一步地构建复杂对象，从而将对象的构建过程与表示分离。
在我们平时的工作中比较常见的构建者模式主要提现在lombok 的@builder 注解以及我们在创建一些复杂对象的时候我们就会使用到构建者模式，比如在@builder 的常见下主要的作用就是用户简化对象的构建，我们使用 builder 的形式可以让我们使用链式变成编程的形式一步一步的构建我们的对象，避免了在代码中大量的去调用 set 方法去对象，提高了代码的没关程度;就拿我们的业务系统而言我们也会在创建一些复杂对象的情况下去使用构建者模式，比如在我们的一个活动营收抽奖系统来说的，我们往往要及时提醒业务方活动产出的-样些高价值奖励，比如现金奖励，大额优惠元等等，因此我们基本上会考虑给业务所在的公司内部钉钉群、企业微信群及时推送一些产出相关的消息，同时我们为了让消息显示的更加简洁我们往往不会推送一个简单的文案而是推送一个 markdown 文本消息，这个 markdown 文本消息对于我们来说就可以算的上一个复杂对象因此我们就可以通过使用构建者模式加上内部类的形式来构建这个对象，通过内部类 builder 去简化掉我们构建 markdown 对象的创建过程
好处是我们可以暴露出简单的构建者 api 去构建复杂的对象。
缺点的就是如果在一些简单的对象上去滥用构建者模式，除了会增加内存中的对象个数也会增加代码的可读程度。

## 讲讲模版方法模式

模板方法模式(Template Method Pattern)是一种行为设计模式，它定义了一个操作中的算法的骨架，而将-些步骤延迟到子类中。通过这种方式，子类可以在不改变算法结构的情况下重新定义算法中的某些步骤。平时在我们工作的也有不少地方可以使用到模板方法模式，就拿活动营收的抽奖系统来说，我们就可以使用的上模板方法模式;抽奖的主要流程基本就是 校验用户的合法性 > 校验奖池的合法性 >用户抽检次数的扣减>用户进行抽奖 >奖励发放 >抽奖明细落地 >抽奖预警及监控，因此我们在设计这个模块的时候我们就可以使用模板方法把上边的这些流程都弄成一个骨架，并配合接口的默认实现、抽象类的默认实现我们就可以提供好-些默认的业务功能，同时当子类业务觉得某些骨架中的方法可能不大适合自己的业务场景的时候，就可以通过重写的方法去覆盖掉这些方法，从而实现对复杂业务的解耦。
优点的话，主要是定义了一个通用骨架，并且合理利用了多态的特点，可以灵活的快速的去兼容业务的迭代变季
弊端的话主要也还是增加了代码编码难度，同时在配合多态的情况下对于新手可能不大友好，可能第一眼不能理解到，业务的调用过程:

## 讲讲单例模式

单例模式(Singleton Pattern)是一种创建型设计模式，它确保一个类只有一个实例，并提供全局访问点。单例模式在许多情况下非常有用，尤其是当需要一个全局对象来协调系统操作时。
平时我们接触对多的单例模式应该属于 spring 的 ioc 容器中的单例对象，使用 spring 中的单例 bean 可以让我们日常的开发中，可以直接的将我们的单例 bean 注入到我们各自的业务类中，避免了在我们不同的业务类中大量的重复的去构建这一些 bean。以及我们某一些线程安全的常见下，如果所有的对象共同来调用这个类中的方法不会导致数据及业务异常，以及不想或者在不能映入 spring ioc 的情况下我们就可以使用注入枚举、内部类、饿汉、饱汉等机制来实现我们的一个单例模式。就拿营收系统的奖池产出预警这个场景来说，我们不同的业务可能会关注钉钉的消息有些人可能关注企业微信群的消息，这样我们就可以真正的发送不同消息的出来通过枚举的形式来实现一个单例 bean。

## 讲讲适配器模式

适配器模式是一种结构型设计模式，它使得接口不兼容的类可以一起工作，即通过将一个类的接口转换成客户端期望的另一个接口，使原本因接口不匹配而无法一起工作的类可以协同工作。
平时在我们工作中使用的比较多的可能是对不同数据的处理，将不同数据的适配成我们可以统一使用的数据比如活动营收系统中的任务模块，往往触发任务的都是一些列不同的消息，比如用户登陆消息、充值消息、心跳消息等等，这时候我们就可以使用适配器模式通过把不同的消息处理成任务处理器可以统一处理的TaskContext 从而可以让任务处理器去统一处理不同的任务类型;同时我们在做一些第三方依赖 jar 的切换的时候我们也可以通过适配器模式将不同 jar 里边的提供的接口适配统一接口，比如系统中以前依赖的redis 客户端是 jedis 现在需要替换成 redisson 这时候我们就可以在 上层抽取一个适配器接口，然后分别用 jedis 和redisson 的实现去实现适配器接口的暴露出来的接口，就可以实现第三方依赖 jar 的快速切换。